p8105_hw2_xz3312
================
Eric Zhang
2025-09-26

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
library(haven)
```

\#Problem 1 \##Let’s import the dataset pols_month and make changes to
it \[problem 1 part 1\]

``` r
pols_month_df = 
  read.csv("fivethirtyeight_datasets/pols-month.csv", na=c("NA",".",""))

library(dplyr)
library(tidyr)

pols_month_clean_df = 
  read.csv("fivethirtyeight_datasets/pols-month.csv", na=c("NA",".","")) %>% 
  as_tibble() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) %>% 
  mutate(
    month = factor(month.name[month], levels = month.name),
    president = if_else(prez_gop == 1, "gop", "dem")
  ) %>% 
  select(-prez_dem, -prez_gop)
```

\##Let’s import the dataset snp.csv and make similar changes to it
\[problem 1 part 2\]

``` r
snp_df =
  read.csv("fivethirtyeight_datasets/snp.csv", na=c("NA",".",""))

library(dplyr)
library(tidyr)

snp_clean_df =
    read.csv("fivethirtyeight_datasets/snp.csv", na=c("NA",".","")) %>%
  as_tibble() %>% 
  separate(date, into = c("month","day","year"), sep = "/", convert = TRUE) %>% 
  mutate(
    year = year + if_else(year>=50L, 1900L,2000L),
    month = factor(month.name[month], levels = month.name)
  ) %>% 
  relocate(year, month, day)
```

\##Let’s import and tidy the unemployment dataset so it can be merged
with previous datasets \[problem 1 part 3\]

``` r
unemployment_df =
   read.csv("fivethirtyeight_datasets/unemployment.csv", na=c("NA",".",""))

library(dplyr)
library(tidyr)
library(janitor)
```

    ## 
    ## Attaching package: 'janitor'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

``` r
library(stringr)

unemployment_clean_df <-
  read.csv("fivethirtyeight_datasets/unemployment.csv",
           na = c("NA", ".", "")) %>%
  as_tibble() %>%
  clean_names() %>%
  pivot_longer(
    cols = jan:dec,              # after clean_names(): jan, feb, ..., dec
    names_to = "month",
    values_to = "unemployment_percentage"
  ) %>%
  mutate(
    month = factor(
      str_to_title(month),       # "jan" -> "Jan"
      levels = month.abb,        # "Jan","Feb",...,"Dec"
      ordered = TRUE
    )
  ) %>%
  arrange(year, month)

pols2  <- pols_month_clean_df  %>% mutate(month = str_to_title(as.character(month)))
snp2   <- snp_clean_df         %>% mutate(month = str_to_title(as.character(month)))
unemp2 <- unemployment_clean_df %>% mutate(month = str_to_title(as.character(month)))

merged_df <- pols2 %>%
  left_join(snp2,  by = c("year", "month")) %>%
  left_join(unemp2, by = c("year", "month"))
```

The pols dataset gives information about the composition of the U.S.
executive and legislative branches by month and year, and which party
holds the office. Snp dataset contains monthly closing values of the
stocks, which connects politics to market performance. Unemployment
dataset gives unemployment percentage by month and year. I wish the
unemployment dataset provided day of the month as well, even if
percentage number is consistent; this would make the dataframe have less
NA values.

\#Problem 2

``` r
library(readxl)
library(dplyr)
library(janitor)
library(lubridate)
mrtrashwheel_df = 
  read_excel("~/Desktop/p8105_homework_2/202409_trashwheel.xlsx", na=c("NA",".",""))
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
mrtrashwheel_df <- mrtrashwheel_df %>%  clean_names()

mrtrashwheel_clean_df <- mrtrashwheel_df %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(
    date = as.Date(as.character(date)),
    sports_balls = as.integer(round(sports_balls))
  )


mrtrashwheel_clean_df %>% 
  select(-x15,-x16)
```

    ## # A tibble: 651 × 14
    ##    dumpster month year  date       weight_tons volume_cubic_yards
    ##       <dbl> <chr> <chr> <date>           <dbl>              <dbl>
    ##  1        1 May   2014  2014-05-16        4.31                 18
    ##  2        2 May   2014  2014-05-16        2.74                 13
    ##  3        3 May   2014  2014-05-16        3.45                 15
    ##  4        4 May   2014  2014-05-17        3.1                  15
    ##  5        5 May   2014  2014-05-17        4.06                 18
    ##  6        6 May   2014  2014-05-20        2.71                 13
    ##  7        7 May   2014  2014-05-21        1.91                  8
    ##  8        8 May   2014  2014-05-28        3.7                  16
    ##  9        9 June  2014  2014-06-05        2.52                 14
    ## 10       10 June  2014  2014-06-11        3.76                 18
    ## # ℹ 641 more rows
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>

\##Do the same for professor trashwheel and gwynnda trashwheel data

``` r
library(readxl)
library(dplyr)
library(janitor)
prof_trashwheel_df <- read_excel(
  path  = "~/Desktop/p8105_homework_2/202409_trashwheel.xlsx",
  sheet = "Professor Trash Wheel",   
  skip  = 1,                         
  na    = c("", "NA", "."),
) 


proftrashwheel_clean_df <- prof_trashwheel_df %>%
  mutate(
    `Homes Powered*` = as.integer(round(`Homes Powered*`)) 
  )

proftrashwheel_clean_df <- proftrashwheel_clean_df[-c(119, 120, 121), ] #I noticed row 119 to 121 had mostly NA values, so I removed them


gwynnda_trashwheel_df <- read_excel(
  path  = "~/Desktop/p8105_homework_2/202409_trashwheel.xlsx",
  sheet = "Gwynnda Trash Wheel",   
  skip  = 1,                         
  na    = c("", "NA", "."),
) 

gwynndatrashwheel_clean_df <- gwynnda_trashwheel_df %>% 
  mutate(
    `Homes Powered*` = as.integer(round(`Homes Powered*`)) #rounded home powered to integer
  )


gwynndatrashwheel_clean_df <- gwynndatrashwheel_clean_df[-c(264), ] #removed row 264 which is NA

proftrashwheel_clean_df   <- proftrashwheel_clean_df   %>% clean_names()
gwynndatrashwheel_clean_df <- gwynndatrashwheel_clean_df %>% clean_names() #make column names all non-capitalized in order to combine them

library(dplyr)
library(purrr)


num_cols <- c(
  "weight_tons","volume_cubic_yards","plastic_bottles","polystyrene",
  "cigarette_butts","glass_bottles","plastic_bags","wrappers",
  "sports_balls","homes_powered"
)


coerce_types <- function(df) {
  df %>%
    mutate(
      year  = as.integer(year),
      month = as.character(month),
      date  = as.Date(date)
    ) %>%
    mutate(across(any_of(num_cols), as.numeric))
}

trashwheel_all <- list(
  mrtrashwheel_clean_df   %>% mutate(wheel = "Mr"),
  proftrashwheel_clean_df %>% mutate(wheel = "Professor"),
  gwynndatrashwheel_clean_df %>% mutate(wheel = "Gwynnda")
) %>%
  map(coerce_types) %>%
  bind_rows() %>%
  select(wheel, everything())


trashwheel_all %>%
  filter(wheel == "Professor") %>%
  summarise(total_weight_tons = sum(weight_tons, na.rm = TRUE))
```

    ## # A tibble: 1 × 1
    ##   total_weight_tons
    ##               <dbl>
    ## 1              247.

``` r
trashwheel_all %>%
  filter(wheel == "Gwynnda", year == 2022, month == "June") %>%
  summarise(total_cigarette_butts = sum(cigarette_butts, na.rm = TRUE))
```

    ## # A tibble: 1 × 1
    ##   total_cigarette_butts
    ##                   <dbl>
    ## 1                 18120

The combined trashwheel_all dataset contains 1032 observations of 17
variables from three datasets, each representing one dumpster’s
collection event from Mr. Trash Wheel, Professor Trash Wheel, or
Gwynnda. Important variables include date (the collection date),
weight_tons (tons of trash removed), and specific counts such as
cigarette butts, plastic bottles, and sports balls. The total weight in
tons collected by professor is 246.76, and the total cigarette butts
collected by Gwynnda in June 2022 is 18120.
